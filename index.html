<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://sandbox.payfast.co.za/onsite/engine.js"></script>
</head>
<body>
    <script>
            // DO NOT MODIFY THE CODE BELOW
            
            // retrieve the uuid that is passed to this file and send it to payfast onsite engine
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            const uuid = urlParams.get('uuid');
            const return_url = urlParams.get('return_url');
            const cancel_url = urlParams.get('cancel_url');

            window.payfast_do_onsite_payment({"uuid":uuid}, function (result) {
                if (result === true) {
                    // Payment Completed
                    location.href = decodeURIComponent(return_url) || 'completed'; // triggers payment completed widget on app
                }
                else {
                    // Payment Window Closed
                    location.href = decodeURIComponent(cancel_url) || 'closed'; // triggers payment cancelled widget on app
                }
            });
        </script>
</body>
</html>
